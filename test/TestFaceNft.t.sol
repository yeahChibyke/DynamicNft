// SPDX-License-Identifier: SEE LICENSE IN LICENSE
pragma solidity >= 0.8.0;

import {Test, console2} from "forge-std/Test.sol";
import {FaceNft} from "../src/FaceNft.sol";
import {DeployFaceNft} from "../script/DeployFaceNft.s.sol";

contract TestFaceNft is Test {
    FaceNft public faceNft;
    DeployFaceNft public deployer;

    string public constant NFT_NAME = "Face NFT";
    string public constant NFT_SYMBOL = "FNFT";

    string public constant NERD_FACE_TOKEN_URI =
        "data:application/json;base64,eyJuYW1lIjoiRmFjZSBORlQiLCAiZGVzY3JpcHRpb24iOiJGYWNlIE5GVCB0aGF0IHJlZmxlY3RzIHRoZSBwZXJzb25hbGl0eSBvZiB0aGUgb3duZXIsIDEwMCUgb24gQ2hhaW4hIiwgImF0dHJpYnV0ZXMiOiBbeyJ0cmFpdF90eXBlIjogInBlcnNvbmFsaXR5IiwgInZhbHVlIjogMTAwfV0sICJpbWFnZSI6ImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU9EQXdjSGdpSUdobGFXZG9kRDBpT0RBd2NIZ2lJSFpwWlhkQ2IzZzlJakFnTUNBMk5DQTJOQ0lnZUcxc2JuTTlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5Mekl3TURBdmMzWm5JaUI0Yld4dWN6cDRiR2x1YXowaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1UazVPUzk0YkdsdWF5SWdZWEpwWVMxb2FXUmtaVzQ5SW5SeWRXVWlJSEp2YkdVOUltbHRaeUlnWTJ4aGMzTTlJbWxqYjI1cFpua2dhV052Ym1sbWVTMHRaVzF2YW1sdmJtVXRiVzl1YjNSdmJtVWlJSEJ5WlhObGNuWmxRWE53WldOMFVtRjBhVzg5SW5oTmFXUlpUV2xrSUcxbFpYUWlQanh3WVhSb0lHUTlJazB6TWlBeVF6RTFMalF6TWlBeUlESWdNVFV1TkRNeUlESWdNekp6TVRNdU5ETXlJRE13SURNd0lETXdjek13TFRFekxqUXpNaUF6TUMwek1GTTBPQzQxTmpnZ01pQXpNaUF5YlRFNExqRXdNeUE1TGpNeU5HRXhOaTQwTVRnZ01UWXVOREU0SURBZ01DQXdMVGd1T1RjNUxTNDVNVFZqTFM0M01ETXVNVE0xTFM0eE9USWdNaTR5Tnk0ek9EZ2dNaTR4TlRaak5DNHhOamd0TGpjME9DQTRMalExTmk0MElERXhMalk1SURNdU1UTXpZeTR4TmpNdU1UUXlMalEyT1M0d01UVXVOelkxTFM0eU1qSmhNamN1TkRreElESTNMalE1TVNBd0lEQWdNU0EwTGpBMklEY3VOalpETlRVdU56TWdNVGt1TkRVMklEVXhMalkxTnlBeE55QTBOeUF4TjJNdE5DNDFNek1nTUMwNExqVXlNU0F5TGpNeU15MHhNQzQ0TkRnZ05TNDROREpqTFRJdU5qZzRMVEV1TVRZNExUVXVPREExTFRFdU1EWXhMVGd1TXpBeExqQXdOME15TlM0MU1qVWdNVGt1TXpJMklESXhMalV6TnlBeE55QXhOeUF4TjJNdE5DNDJOVGNnTUMwNExqY3pJREl1TkRVM0xURXhMakF5TmlBMkxqRXpOMkV5Tnk0ME5qZ2dNamN1TkRZNElEQWdNQ0F4SURRdU1UTTJMVGN1TnpVNFl5NHlOeTR4T1RjdU5UTTRMakk1T1M0Mk9EWXVNVFk1WVRFMExqSXpNeUF4TkM0eU16TWdNQ0F3SURFZ01URXVOamt5TFRNdU1UTXpZeTQxT0M0eE1UTWdNUzR3T1RJdE1pNHdNakV1TXpnNUxUSXVNVFUyWVRFMkxqUXhNU0F4Tmk0ME1URWdNQ0F3SURBdE9DNDJOekl1T0VNeE9TNHdNRFlnTmk0NU56TWdNalV1TWpFNElEUXVOU0F6TWlBMExqVmpOaTQ1TWpnZ01DQXhNeTR5TmpJZ01pNDFPREVnTVRndU1UQXpJRFl1T0RJMFRUVTNJRE13WXpBZ05TNDFNakV0TkM0ME56a2dNVEF0TVRBZ01UQnpMVEV3TFRRdU5EYzVMVEV3TFRFd1l6QXROUzQxTWpRZ05DNDBOemt0TVRBZ01UQXRNVEJ6TVRBZ05DNDBOellnTVRBZ01UQnRMVEk1TGprNU9TQXdZekFnTlM0MU1qTXROQzQwTnprZ01UQXRNVEF1TURBeElERXdZeTAxTGpVeU1pQXdMVEV3TFRRdU5EYzNMVEV3TFRFd1l6QXROUzQxTWpRZ05DNDBOemN0TVRBZ01UQXRNVEJ6TVRBdU1EQXhJRFF1TkRjMklERXdMakF3TVNBeE1FMHpNaUExT1M0MVl5MHhOQzQxTmpNZ01DMHlOaTQxTVRFdE1URXVNemM1TFRJM0xqUXpOaTB5TlM0M01USkROaTR4T0RjZ016a3VNVEU1SURFeExqRXpPU0EwTXlBeE55QTBNMk0zTGpFNElEQWdNVE10TlM0NE1pQXhNeTB4TTJNd0xURXVNamMyTFM0eE9URXRNaTQxTURZdExqVXpOQzB6TGpZM01XTXhMalV6TFM0ME16WWdNeTQxTkMwdU5ETTBJRFV1TURZNExqQXdNVUV4TWk0NU5qUWdNVEl1T1RZMElEQWdNQ0F3SURNMElETXdZekFnTnk0eE9DQTFMamd5SURFeklERXpJREV6WXpVdU9EWXhJREFnTVRBdU9ERXpMVE11T0RneElERXlMalF6TmkwNUxqSXhNa00xT0M0MU1URWdORGd1TVRJeElEUTJMalUyTXlBMU9TNDFJRE15SURVNUxqVWlJR1pwYkd3OUlpTXdNREF3TURBaVBqd3ZjR0YwYUQ0OFpXeHNhWEJ6WlNCamVEMGlNakFpSUdONVBTSXpNQzQxSWlCeWVEMGlOQ0lnY25rOUlqVWlJR1pwYkd3OUlpTXdNREF3TURBaVBqd3ZaV3hzYVhCelpUNDhaV3hzYVhCelpTQmplRDBpTkRRaUlHTjVQU0l6TUM0MUlpQnllRDBpTkNJZ2NuazlJalVpSUdacGJHdzlJaU13TURBd01EQWlQand2Wld4c2FYQnpaVDQ4Y0dGMGFDQmtQU0pOTkRFdU5EQTBJRFExTGpFMVl5MHpMakl5TXlBeUxqSTJPUzA0TGpNMU15QXpMamd6TkMweE15NDJOaUF5TGpRek0yTXRNUzQwTWpFdExqTTNOeTB5TGpVek5TQXpMak14TFRFdU1ERTRJRE11TnpNell6VXVOelkzSURFdU5UVWdNVEl1TURRNUxqUXlPU0F4Tmk0NU15MHpMakF4TkdNeExqSXdOUzB1T0RZNExURXVNRFUwTFRRdU1ESTNMVEl1TWpVeUxUTXVNVFV5SWlCbWFXeHNQU0lqTURBd01EQXdJajQ4TDNCaGRHZytQQzl6ZG1jKyJ9";
    string public constant NINJA_FACE_TOKEN_URI =
        "data:application/json;base64,eyJuYW1lIjoiRmFjZSBORlQiLCAiZGVzY3JpcHRpb24iOiJGYWNlIE5GVCB0aGF0IHJlZmxlY3RzIHRoZSBwZXJzb25hbGl0eSBvZiB0aGUgb3duZXIsIDEwMCUgb24gQ2hhaW4hIiwgImF0dHJpYnV0ZXMiOiBbeyJ0cmFpdF90eXBlIjogInBlcnNvbmFsaXR5IiwgInZhbHVlIjogMTAwfV0sICJpbWFnZSI6ImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU9EQXdjSGdpSUdobGFXZG9kRDBpT0RBd2NIZ2lJSFpwWlhkQ2IzZzlJakFnTUNBMU1USWdOVEV5SWlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpUGp4d1lYUm9JR1pwYkd3OUlpTXdNREF3TURBaUlHUTlJazB5T0RBdU1EVTBJREU1TGpnMk4yTXROalF1TXpFMUlEQXRNVEl4TGpjMklESTRMamM1TXkweE5Ua3VOalF6SURjekxqa3pOQ0F5Tnk0ek9EY3VNRGNnT0RjdU9USTRJRE11TURVZ09UWXVNVElnTWpVdU56STJMVE00TGpReE5DMHhNaTR4TURVdE56a3VOelV6TFRFeExqSTJMVEV3T0M0MU16UXRPUzR6TURKaE1qQXhMakF4TXlBeU1ERXVNREV6SURBZ01DQXdMVEV6TGpZMU5pQXlNeTR6TVRSak16RXVOVEEzTFRndU16QTNJREUwTnk0NU9UZ3RNeTR6TnlBeE5UUXVPQ0F5TVM0eU5qZ3ROelV1T1RnMUxURTRMall5TkMweE5EQXVOVGt0T0M0Mk5TMHhOakl1TURVNExUUXVPRGsxTFRndU56WTRJREl5TGpRME5pMHhNeTQxT0RRZ05EWXVPREExTFRFekxqVTROQ0EzTWk0eU56SWdNQ0F4TVRFdU56TTJJRGsyTGpJME9DQXlOamt1T1RRNUlESXhNQzR6TWpRZ01qWTVMamswT1NBMU55NDRNRGdnTUNBeE1Ea3VNUzAwTUM0Mk15QXhORFV1TmpNM0xUazFMakkwT0Mwek1TNDBNRE1nTWpNdU9ERXlMVGs0TGpBMElEVTNMak13T0MweE16a3VNREF5SURNMExqWTBPQ0E0TVM0MU9USXRPQzQ1T1RRZ01UTTVMamsyTlMwMU1DNDVOemdnTVRVMkxqRTVMVFl6TGpNMU15QXlOUzR5TURjdE5EY3VNVFF5SURNNUxqazFPUzB4TURBdU5ETXlJRE01TGprMU9TMHhORFV1T1RrMklEQXRNVEV4TGpjek55MDVNaTQwTnpjdE1qQXlMak14TnkweU1EWXVOVFV6TFRJd01pNHpNVGQ2YlMwdU1EQXlJREUxTVM0Mk9USmpNVEExTGpBNE5DQXdJREU1TUM0eU56TWdNamN1TnpJM0lERTVNQzR5TnpNZ05qRXVPVE14SURBZ01qSXVNRFEzTFRRdU5EazFJRE16TGpRNExUVTNMamM1TnlBME5DNDBOVE10TWprdU16a2dOaTR3TlRJdE9UVXVNVEkzTFRNeExqRTRNUzB4TXpJdU5EYzJMVE14TGpFNE1TMHpOQzQ0TmpRZ01DMDROeTR4TWlBME1TNHpORFV0TVRFMUxqSXhPU0F6Tmk0d01UY3ROVFl1TlRrM0xURXdMamN6TWkwM05TNHdOVE10TWpZdU5ETXpMVGMxTGpBMU15MDBPUzR5T0RrZ01DMHpOQzR5TURRZ09EVXVNVGc0TFRZeExqa3pNU0F4T1RBdU1qY3lMVFl4TGprek1YcHRPRE11T0RnMUlETTVMamc1TkdNdE1qQXVNVFF0TGpFeUxUUXhMalUzTVNBekxqSTVOUzAwTVM0ME56VWdPUzQ1TVM0eE9ESWdNVEl1TkRVeklERTNMak0yTkNBeU1pNHlPVGdnTXpndU16YzNJREl4TGprNUlESXhMakF4TXkwdU16QTJJREU0TGpVMU5TMHhOaTR5TVRZZ016Y3VOekUzTFRJekxqRXdNUzB1TURnMUxUVXVPRE0zTFRFMkxqZzFMVGd1TmprekxUTTBMall5TFRndU56azVlbTB0TVRjeUxqWTRNaUF5TGpnNE0yTXRNVGN1TnpjdU1UQTFMVE0wTGpVek5DQXlMamsyTkMwek5DNDJNaUE0TGpnZ01Ua3VNVFl5SURZdU9EZzFJREUyTGpjd05DQXlNaTQzT1RZZ016Y3VOekU0SURJekxqRXdNaUF5TVM0d01UTXVNekEzSURNNExqRTVOUzA1TGpVMElETTRMak0zTnkweU1TNDVPVEl1TURrMkxUWXVOakUxTFRJeExqTXpOaTB4TUM0d015MDBNUzQwTnpVdE9TNDVNWHB0T1RJdU5UY2dPREl1TkRReFl6TXhMakF6TWlBd0lEVTJMakU0T0NBeU5TNHlNelVnTlRZdU1UZzRJREkxTGpJek5YTXRNamd1TVRnMExURXhMakV3TkMwMU9TNHlNVGN0TVRFdU1UQTBZeTB6TVM0d016SWdNQzAxTXk0eE5pQXhNUzR4TURRdE5UTXVNVFlnTVRFdU1UQTBjekkxTGpFMU5pMHlOUzR5TXpVZ05UWXVNVGt0TWpVdU1qTTFlazB6TVM0eU5TQTBNVEV1TXpsak5DNHpORFFnTWk0d05EWWdOeTQzT0RNdE5EQXVNek0ySURVeUxqSTBOaTAyTVM0eU5qVXRPQzR4TVRFdE9DNDBOalV0TVRJdU5ETTRMVEkwTGpZek9DMHhOQzR5TkMwek5TNDFNREl0TXpJdU56TXpJRFF1TVRVNExUVTFMakF4TWlBNE5DNDRPRGN0TXpndU1EQTJJRGsyTGpjMk4zcHROVFl1TXpFdE5ERXVOamswWXkwM0xqVXhNUzB1TURVeUxURTNMakkyTFM0eU1qZ3RNVGN1TkRRMUlERTJMamt6TnkwdU5EazRJRFEyTGpNeExUUXlMamd3TlNBNU5pNDVOVE10TkRBdU1USTRJRGs0TGpJeE5TQTNMakV6T0NBekxqTTJOQ0EwT1M0MU9UZ3RNekl1TURjM0lEWXhMamt3TmkwMU9TNDBOQ0EwTGpFMU9TMDVMakkwTkNBeE1TNDFNVFl0TlRVdU5qQXpMVFF1TXpNekxUVTFMamN4TW5vaUx6NDhMM04yWno0PSJ9";
    string public constant SMILE_FACE_TOKEN_URI =
        "data:application/json;base64,eyJuYW1lIjoiRmFjZSBORlQiLCAiZGVzY3JpcHRpb24iOiJGYWNlIE5GVCB0aGF0IHJlZmxlY3RzIHRoZSBwZXJzb25hbGl0eSBvZiB0aGUgb3duZXIsIDEwMCUgb24gQ2hhaW4hIiwgImF0dHJpYnV0ZXMiOiBbeyJ0cmFpdF90eXBlIjogInBlcnNvbmFsaXR5IiwgInZhbHVlIjogMTAwfV0sICJpbWFnZSI6ImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5Qm9aV2xuYUhROUlqZ3dNSEI0SWlCM2FXUjBhRDBpT0RBd2NIZ2lJSFpsY25OcGIyNDlJakV1TVNJZ2FXUTlJa05oY0dGZk1TSWdlRzFzYm5NOUltaDBkSEE2THk5M2QzY3Vkek11YjNKbkx6SXdNREF2YzNabklpQjRiV3h1Y3pwNGJHbHVhejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TVRrNU9TOTRiR2x1YXlJZ0RRb0pJSFpwWlhkQ2IzZzlJakFnTUNBME5USXVPVGcySURRMU1pNDVPRFlpSUhodGJEcHpjR0ZqWlQwaWNISmxjMlZ5ZG1VaVBnMEtQR2MrRFFvSlBHYytEUW9KQ1R4blBnMEtDUWtKUEhCaGRHZ2djM1I1YkdVOUltWnBiR3c2SXpBeE1EQXdNanNpSUdROUlrMHlNall1TkRrekxEQkRNVEF4TGpVM055d3dMREFzTVRBeExqVTNOeXd3TERJeU5pNDBPVE5qTUN3eE1qUXVPRGN6TERFd01TNDFOemNzTWpJMkxqUTVNeXd5TWpZdU5Ea3pMREl5Tmk0ME9UTU5DZ2tKQ1Fsak1USTBMamcxTWl3d0xESXlOaTQwT1RNdE1UQXhMall5TERJeU5pNDBPVE10TWpJMkxqUTVNME0wTlRJdU9UZzJMREV3TVM0MU56Y3NNelV4TGpNME5Td3dMREl5Tmk0ME9UTXNNSG9nVFRJeU5pNDBPVE1zTkRJM0xqYzVNZzBLQ1FrSkNXTXRNVEV4TGpBME5pd3dMVEl3TVM0ek1pMDVNQzR5T1RVdE1qQXhMak15TFRJd01TNHlPVGxqTUMweE1URXVNREkxTERrd0xqSTNOQzB5TURFdU16UXlMREl3TVM0ek1pMHlNREV1TXpReVl6RXhNQzQ1T0RJc01Dd3lNREV1TWpjM0xEa3dMak14Tnl3eU1ERXVNamMzTERJd01TNHpORElOQ2drSkNRbEROREkzTGpjM0xETXpOeTQwT1RZc016TTNMalEzTlN3ME1qY3VOemt5TERJeU5pNDBPVE1zTkRJM0xqYzVNbm9pTHo0TkNna0pDVHh3WVhSb0lITjBlV3hsUFNKbWFXeHNPaU13TVRBd01ESTdJaUJrUFNKTk1UUTNMakk0TlN3eU1qSXVOVEF6WXpFMkxqZ3lOU3d3TERNd0xqUTFPQzB4TXk0MU5EWXNNekF1TkRVNExUTXdMak0xWXpBdE1UWXVPREEwTFRFekxqWXpNeTB6TUM0ek9UTXRNekF1TkRVNExUTXdMak01TXcwS0NRa0pDV010TVRZdU56RTNMREF0TXpBdU16a3pMREV6TGpVNUxUTXdMak01TXl3ek1DNHpPVE5UTVRNd0xqVTJPQ3d5TWpJdU5UQXpMREUwTnk0eU9EVXNNakl5TGpVd00zb2lMejROQ2drSkNUeGphWEpqYkdVZ2MzUjViR1U5SW1acGJHdzZJekF4TURBd01qc2lJR040UFNJek1EVXVOak0ySWlCamVUMGlNVGt5TGpFek1TSWdjajBpTXpBdU16Y3lJaTgrRFFvSkNRazhjR0YwYUNCemRIbHNaVDBpWm1sc2JEb2pNREV3TURBeU95SWdaRDBpVFRJeU5pNDBPVE1zTXpjMUxqWTFOV00yTUM0ek9UZ3NNQ3d4TVRJdU1ERTNMVE0yTGpBNE9Dd3hNelV1TlRBNExUZzNMamMzTWtnNU1TNHdNRGNOQ2drSkNRbERNVEUwTGpReE1Td3pNemt1TlRZM0xERTJOaTR3TXl3ek56VXVOalUxTERJeU5pNDBPVE1zTXpjMUxqWTFOWG9pTHo0TkNna0pQQzluUGcwS0NUd3ZaejROQ2drOFp6NE5DZ2s4TDJjK0RRb0pQR2MrRFFvSlBDOW5QZzBLQ1R4blBnMEtDVHd2Wno0TkNnazhaejROQ2drOEwyYytEUW9KUEdjK0RRb0pQQzluUGcwS0NUeG5QZzBLQ1R3dlp6NE5DZ2s4Wno0TkNnazhMMmMrRFFvSlBHYytEUW9KUEM5blBnMEtDVHhuUGcwS0NUd3ZaejROQ2drOFp6NE5DZ2s4TDJjK0RRb0pQR2MrRFFvSlBDOW5QZzBLQ1R4blBnMEtDVHd2Wno0TkNnazhaejROQ2drOEwyYytEUW9KUEdjK0RRb0pQQzluUGcwS0NUeG5QZzBLQ1R3dlp6NE5Dand2Wno0TkNqd3ZjM1puUGc9PSJ9";

    address Chibyke = makeAddr("Chibyke");

    function setUp() public {
        deployer = new DeployFaceNft();
        faceNft = deployer.run();
    }

    // >-----FaceNft Tests-----<

    function testInitializedCorrectly() public view {
        assert(keccak256(abi.encodePacked(faceNft.name())) == keccak256(abi.encodePacked(NFT_NAME)));
        assert(keccak256(abi.encodePacked(faceNft.symbol())) == keccak256(abi.encodePacked(NFT_SYMBOL)));
    }

    // This particular test helped me get the tokenURIs of all the Faces
    function testCanViewTokenURI() public {
        vm.prank(Chibyke);

        faceNft.mintNft();

        console2.log(faceNft.tokenURI(0));
    }

    function testConfirmFirstMintIsNerd() public {
        vm.prank(Chibyke);
        faceNft.mintNft();

        assert(keccak256(abi.encodePacked(faceNft.tokenURI(0))) == keccak256(abi.encodePacked(NERD_FACE_TOKEN_URI)));
    }

    function testCanMintAndHaveBalance() public {
        vm.prank(Chibyke);
        faceNft.mintNft();

        assert(faceNft.balanceOf(Chibyke) == 1);
    }

    function testFlipFaceToNerd() public {
        vm.startPrank(Chibyke);
        faceNft.mintNft();
        faceNft.flipFaceToNerd(0);
        vm.stopPrank();

        assert(keccak256(abi.encodePacked(faceNft.tokenURI(0))) == keccak256(abi.encodePacked(NERD_FACE_TOKEN_URI)));
    }

    function testFlipFaceToNinja() public {
        vm.startPrank(Chibyke);
        faceNft.mintNft();
        faceNft.flipFaceToNinja(0);
        vm.stopPrank();

        assert(keccak256(abi.encodePacked(faceNft.tokenURI(0))) == keccak256(abi.encodePacked(NINJA_FACE_TOKEN_URI)));
    }

    function testFlipFaceToSmile() public {
        vm.startPrank(Chibyke);
        faceNft.mintNft();
        faceNft.flipFaceToSmile(0);
        vm.stopPrank();

        assert(keccak256(abi.encodePacked(faceNft.tokenURI(0))) == keccak256(abi.encodePacked(SMILE_FACE_TOKEN_URI)));
    }
}
